# Architecture Documentation

## 🏗️ Detailed System Architecture

### High-Level Architecture Flow

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                AWS Cloud                                        │
│                                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐             │
│  │   Developer     │    │   AWS CodeBuild │    │   Amazon ECR    │             │
│  │   Workstation   │───▶│   CI/CD         │───▶│   Container     │             │
│  │                 │    │   Pipeline      │    │   Registry      │             │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘             │
│                                  │                       │                      │
│                                  ▼                       ▼                      │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐             │
│  │   Internet      │    │   Amazon EKS    │    │   Application   │             │
│  │   Users         │◀───│   Kubernetes    │◀───│   Load Balancer │             │
│  │                 │    │   Cluster       │    │   (ALB)         │             │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘             │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 🔄 CI/CD Pipeline Flow

```
┌─────────────────┐
│   Git Push      │
│   Source Code   │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│   CodeBuild     │
│   Triggered     │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│   Build Phase   │
│   - npm install │
│   - npm build   │
│   - Docker build│
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│   Push to ECR   │
│   - Tag image   │
│   - Push latest │
│   - Push commit │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│   Update K8s    │
│   Manifests     │
│   - Replace IDs │
│   - Output      │
│     Artifacts   │
└─────────────────┘
```

## 🏛️ Kubernetes Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                        Amazon EKS Cluster                      │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                  ai-ops-workshop                        │    │
│  │                    Namespace                            │    │
│  │                                                         │    │
│  │  ┌─────────────────┐    ┌─────────────────┐            │    │
│  │  │   Pod 1         │    │   Pod 2         │            │    │
│  │  │                 │    │                 │            │    │
│  │  │  ┌───────────┐  │    │  ┌───────────┐  │            │    │
│  │  │  │ Container │  │    │  │ Container │  │            │    │
│  │  │  │ ai-ops    │  │    │  │ ai-ops    │  │            │    │
│  │  │  │ :3000     │  │    │  │ :3000     │  │            │    │
│  │  │  └───────────┘  │    │  └───────────┘  │            │    │
│  │  └─────────────────┘    └─────────────────┘            │    │
│  │                                                         │    │
│  │  ┌─────────────────────────────────────────────────┐    │    │
│  │  │              Service                            │    │    │
│  │  │         ai-ops-react-app-service               │    │    │
│  │  │              Port 80 → 3000                    │    │    │
│  │  └─────────────────────────────────────────────────┘    │    │
│  │                                                         │    │
│  │  ┌─────────────────────────────────────────────────┐    │    │
│  │  │              Ingress                            │    │    │
│  │  │         ai-ops-react-app-ingress               │    │    │
│  │  │    Host: aiops.eoalola.people.aws.dev         │    │    │
│  │  └─────────────────────────────────────────────────┘    │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                  AWS Application Load Balancer                 │
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐                    │
│  │   Target Group  │    │   Health Check  │                    │
│  │   EKS Pods      │    │   /health       │                    │
│  │   Port 3000     │    │   HTTP 200      │                    │
│  └─────────────────┘    └─────────────────┘                    │
└─────────────────────────────────────────────────────────────────┘
```

## 🐳 Container Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                    Docker Multi-Stage Build                    │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                   Build Stage                           │    │
│  │                node:18-alpine                           │    │
│  │                                                         │    │
│  │  ┌─────────────────┐    ┌─────────────────┐            │    │
│  │  │   npm install   │───▶│   npm run build │            │    │
│  │  │   Dependencies  │    │   React Build   │            │    │
│  │  └─────────────────┘    └─────────────────┘            │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                │                                │
│                                ▼                                │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                Production Stage                         │    │
│  │                nginx:alpine                             │    │
│  │                                                         │    │
│  │  ┌─────────────────┐    ┌─────────────────┐            │    │
│  │  │   Static Files  │    │   Nginx Server  │            │    │
│  │  │   /build/*      │───▶│   Port 3000     │            │    │
│  │  └─────────────────┘    └─────────────────┘            │    │
│  │                                                         │    │
│  │  ┌─────────────────────────────────────────────────┐    │    │
│  │  │              Health Check                       │    │    │
│  │  │    wget http://localhost:3000/health           │    │    │
│  │  └─────────────────────────────────────────────────┘    │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
```

## 🔒 Security Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                        Security Layers                         │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                   Network Layer                         │    │
│  │                                                         │    │
│  │  • HTTPS Enforcement (SSL Redirect)                    │    │
│  │  • ALB Security Groups                                 │    │
│  │  • VPC Network Isolation                               │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                Container Layer                          │    │
│  │                                                         │    │
│  │  • ECR Image Scanning                                  │    │
│  │  • Container Resource Limits                           │    │
│  │  • Non-root User (Nginx)                               │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │               Kubernetes Layer                          │    │
│  │                                                         │    │
│  │  • Namespace Isolation                                 │    │
│  │  • Resource Quotas                                     │    │
│  │  • Health Check Probes                                 │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                  AWS Layer                              │    │
│  │                                                         │    │
│  │  • IAM Roles and Policies                              │    │
│  │  • ECR Repository Permissions                          │    │
│  │  • EKS Cluster Security                                │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
```

## 📊 Resource Allocation

```
┌─────────────────────────────────────────────────────────────────┐
│                    Resource Management                          │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                   Per Pod Resources                     │    │
│  │                                                         │    │
│  │  CPU Requests:    100m (0.1 CPU cores)                 │    │
│  │  CPU Limits:      200m (0.2 CPU cores)                 │    │
│  │  Memory Requests: 128Mi                                 │    │
│  │  Memory Limits:   256Mi                                 │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                 Total Cluster Usage                     │    │
│  │                    (2 Replicas)                         │    │
│  │                                                         │    │
│  │  Total CPU Requests:    200m (0.2 CPU cores)           │    │
│  │  Total CPU Limits:      400m (0.4 CPU cores)           │    │
│  │  Total Memory Requests: 256Mi                           │    │
│  │  Total Memory Limits:   512Mi                           │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
```

## 🔄 Health Check Flow

```
┌─────────────────┐
│   ALB Health    │
│   Check         │
│   /health       │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│   Kubernetes    │
│   Service       │
│   Port 80       │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│   Pod           │
│   Readiness     │
│   Probe         │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│   Container     │
│   /health       │
│   Port 3000     │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│   React App     │
│   Health        │
│   Component     │
└─────────────────┘
```

## 🚀 Deployment Workflow

```
┌─────────────────┐
│   Developer     │
│   git push      │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│   CodeBuild     │
│   Webhook       │
│   Trigger       │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│   Build &       │
│   Test          │
│   Application   │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│   Build &       │
│   Push Docker   │
│   Image         │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│   Process K8s   │
│   Manifests     │
│   (Replace IDs) │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│   Deploy to     │
│   EKS Cluster   │
│   (Manual)      │
└─────────────────┘
```
